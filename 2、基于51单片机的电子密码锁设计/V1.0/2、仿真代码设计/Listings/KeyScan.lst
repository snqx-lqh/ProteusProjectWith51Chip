C51 COMPILER V9.60.0.0   KEYSCAN                                                           06/16/2023 18:46:45 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE KEYSCAN
OBJECT MODULE PLACED IN .\Objects\KeyScan.obj
COMPILER INVOKED BY: I:\Program\Keil5\C51\BIN\C51.EXE KeyScan.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\List
                    -ings\KeyScan.lst) OBJECT(.\Objects\KeyScan.obj)

line level    source

   1          #include "KeyScan.h"
   2          
   3          u8 KeyValue = 0;
   4          u8 KeyState = 0; //1 为按下 0 为抬起
   5          
   6          /**
   7            * @name    KeyScan
   8            * @brief   按键检测函数
   9            * @param   : [输入/出] 
  10            * @retval  返回值
  11            */
  12          void KeyScan(void)
  13          {
  14   1          static u8 count = 0;
  15   1              GPIO_KEY=0x0f;
  16   1              if(GPIO_KEY!=0x0f && KeyState == 0)
  17   1              {
  18   2              count ++;
  19   2                      if(GPIO_KEY!=0x0f && count > 2 && KeyState == 0)
  20   2                      {
  21   3                  count = 0;
  22   3                              KeyState = 1;
  23   3                              //列
  24   3                              GPIO_KEY=0X0F;
  25   3                              switch(GPIO_KEY)
  26   3                              {
  27   4                                      case(0X07):     KeyValue=1;break;
  28   4                                      case(0X0b):     KeyValue=2;break;
  29   4                                      case(0X0d): KeyValue=3;break;
  30   4                                      case(0X0e):     KeyValue=4;break;
  31   4                              }
  32   3                              //行
  33   3                              GPIO_KEY=0XF0;
  34   3                              switch(GPIO_KEY)
  35   3                              {
  36   4                                      case(0X70):     KeyValue=KeyValue;break;
  37   4                                      case(0Xb0):     KeyValue=KeyValue+4;break;
  38   4                                      case(0Xd0): KeyValue=KeyValue+8;break;
  39   4                                      case(0Xe0):     KeyValue=KeyValue+12;break;
  40   4                              }
  41   3                      }
  42   2              }else if(GPIO_KEY==0x0F && KeyState == 1)
  43   1          {
  44   2              KeyState = 0;
  45   2              KeyValue = 0;
  46   2          }
  47   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    136    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
C51 COMPILER V9.60.0.0   KEYSCAN                                                           06/16/2023 18:46:45 PAGE 2   

   DATA SIZE        =      3    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
